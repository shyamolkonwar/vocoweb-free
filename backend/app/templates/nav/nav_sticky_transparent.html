<!-- Sticky Transparent Navigation -->
<!-- Starts transparent, becomes solid on scroll -->
<!-- Variables: business_name, logo_url, primary_color, accent_color, pages, phone -->

<nav id="main-nav" class="fixed top-0 left-0 right-0 z-50 transition-all duration-500">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-20">
            <!-- Logo -->
            <a href="index.html" class="flex items-center gap-3">
                {% if logo_url %}
                <img src="{{ logo_url }}" alt="{{ business_name }}" class="h-10 w-auto">
                {% else %}
                <span class="text-2xl font-bold nav-logo-text transition-colors duration-300"
                    style="color: {{ primary_color }};">
                    {{ business_name }}
                </span>
                {% endif %}
            </a>

            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center gap-8">
                {% for page in pages %}
                <a href="{{ page.url }}"
                    class="nav-link text-sm font-medium transition-all duration-300 relative group">
                    {{ page.label }}
                    <span class="absolute -bottom-1 left-0 w-0 h-0.5 group-hover:w-full transition-all duration-300"
                        style="background: {{ primary_color }};"></span>
                </a>
                {% endfor %}

                <!-- CTA Button -->
                {% if phone %}
                <a href="tel:{{ phone }}"
                    class="nav-cta-btn inline-flex items-center gap-2 px-5 py-2.5 rounded-full font-semibold text-sm transition-all duration-300 transform hover:scale-105"
                    style="background: {{ primary_color }}; color: white;">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    {{ labels.call_now | default("Call Now") }}
                </a>
                {% else %}
                <a href="contact.html"
                    class="nav-cta-btn inline-flex items-center gap-2 px-5 py-2.5 rounded-full font-semibold text-sm transition-all duration-300 transform hover:scale-105"
                    style="background: {{ primary_color }}; color: white;">
                    {{ labels.contact_us | default("Contact Us") }}
                </a>
                {% endif %}
            </div>

            <!-- Mobile Menu Button -->
            <button id="mobile-menu-btn" onclick="toggleMobileMenu()"
                class="md:hidden w-10 h-10 rounded-lg flex items-center justify-center transition-colors">
                <div class="hamburger-lines w-6 h-5 relative">
                    <span class="hamburger-line block absolute w-full h-0.5 rounded transition-all duration-300"
                        style="background: currentColor; top: 0;"></span>
                    <span class="hamburger-line block absolute w-full h-0.5 rounded transition-all duration-300"
                        style="background: currentColor; top: 50%; transform: translateY(-50%);"></span>
                    <span class="hamburger-line block absolute w-full h-0.5 rounded transition-all duration-300"
                        style="background: currentColor; bottom: 0;"></span>
                </div>
            </button>
        </div>
    </div>
</nav>

<!-- Mobile Menu Overlay -->
<div id="mobile-menu" class="fixed inset-0 z-40 hidden">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="toggleMobileMenu()"></div>

    <!-- Menu Panel -->
    <div class="absolute right-0 top-0 h-full w-80 max-w-full transform translate-x-full transition-transform duration-500"
        id="mobile-menu-panel"
        style="background: linear-gradient(180deg, {{ primary_color }} 0%, {{ accent_color }} 100%);">
        <!-- Close Button -->
        <button onclick="toggleMobileMenu()"
            class="absolute top-6 right-6 w-10 h-10 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center transition-colors">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>

        <!-- Menu Content -->
        <div class="h-full flex flex-col justify-center px-8">
            <!-- Navigation Links -->
            <nav class="space-y-2 mb-10">
                {% for page in pages %}
                <a href="{{ page.url }}"
                    class="block text-2xl font-bold text-white/90 hover:text-white py-3 transition-colors border-b border-white/10">
                    {{ page.label }}
                </a>
                {% endfor %}
            </nav>

            <!-- Contact Info -->
            <div class="space-y-4">
                {% if phone %}
                <a href="tel:{{ phone }}"
                    class="flex items-center gap-3 text-white/80 hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                    </svg>
                    {{ phone }}
                </a>
                {% endif %}

                {% if email %}
                <a href="mailto:{{ email }}"
                    class="flex items-center gap-3 text-white/80 hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    {{ email }}
                </a>
                {% endif %}
            </div>

            <!-- CTA Button -->
            <a href="contact.html"
                class="mt-8 inline-flex items-center justify-center gap-2 px-6 py-4 rounded-xl bg-white font-bold transition-transform hover:scale-105"
                style="color: {{ primary_color }};">
                {{ labels.get_quote | default("Get a Quote") }}
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M14 5l7 7m0 0l-7 7m7-7H3" />
                </svg>
            </a>
        </div>
    </div>
</div>

<style>
    /* Initial transparent state */
    #main-nav {
        background: transparent;
    }

    #main-nav .nav-link {
        color: white;
    }

    #main-nav .nav-logo-text {
        color: white;
    }

    #main-nav #mobile-menu-btn {
        color: white;
    }

    /* Scrolled state */
    #main-nav.scrolled {
        background: rgba(255, 255, 255, 0.98);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.08);
        backdrop-filter: blur(10px);
    }

    #main-nav.scrolled .nav-link {
        color: #374151;
    }

    #main-nav.scrolled .nav-link:hover {
        color: {
                {
                primary_color
            }
        }

        ;
    }

    #main-nav.scrolled .nav-logo-text {
        color: {
                {
                primary_color
            }
        }

        ;
    }

    #main-nav.scrolled #mobile-menu-btn {
        color: #374151;
    }

    /* Hamburger animation */
    .menu-open .hamburger-lines span:first-child {
        transform: translateY(9px) rotate(45deg);
    }

    .menu-open .hamburger-lines span:nth-child(2) {
        opacity: 0;
    }

    .menu-open .hamburger-lines span:last-child {
        transform: translateY(-9px) rotate(-45deg);
    }
</style>

<script>
    // Scroll behavior for nav
    let lastScroll = 0;
    const nav = document.getElementById('main-nav');

    window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;

        if (currentScroll > 50) {
            nav.classList.add('scrolled');
        } else {
            nav.classList.remove('scrolled');
        }

        lastScroll = currentScroll;
    });

    // Mobile menu toggle
    function toggleMobileMenu() {
        const menu = document.getElementById('mobile-menu');
        const panel = document.getElementById('mobile-menu-panel');
        const body = document.body;

        if (menu.classList.contains('hidden')) {
            menu.classList.remove('hidden');
            body.classList.add('menu-open');
            body.style.overflow = 'hidden';
            setTimeout(() => {
                panel.classList.remove('translate-x-full');
            }, 10);
        } else {
            panel.classList.add('translate-x-full');
            body.classList.remove('menu-open');
            setTimeout(() => {
                menu.classList.add('hidden');
                body.style.overflow = '';
            }, 500);
        }
    }

    // Close menu on escape
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            const menu = document.getElementById('mobile-menu');
            if (!menu.classList.contains('hidden')) {
                toggleMobileMenu();
            }
        }
    });
</script>